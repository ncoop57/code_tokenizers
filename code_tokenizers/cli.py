# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/01_cli.ipynb.

# %% auto 0
__all__ = ['download_grammars']

# %% ../nbs/01_cli.ipynb 2
import code_tokenizers

from fastcore.script import *
from git import Git, Repo
from pathlib import Path
from tree_sitter import Language

# %% ../nbs/01_cli.ipynb 4
_GRAMMARs = {
    "python": ("https://github.com/tree-sitter/tree-sitter-python.git", "tree-sitter-python", "v0.20.0"),
}

# %% ../nbs/01_cli.ipynb 5
def download_grammars():
    languages = []
    for lang, (url, dir, tag) in _GRAMMARs.items():
        repo_dir = Path(code_tokenizers.__path__[0])/dir
        if not repo_dir.exists():
            repo = Repo.clone_from(url, repo_dir)
        g = Git(str(repo_dir))
        g.checkout(tag)
        languages.append(str(repo_dir))
    
    Language.build_library(
        # Store the library in the directory
        str(Path(code_tokenizers.__path__[0])/"tree-sitter-languages.so"),
        # Include one or more languages
        languages
    )
